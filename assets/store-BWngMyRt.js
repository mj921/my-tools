var l=Object.defineProperty;var p=(o,a,t)=>a in o?l(o,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[a]=t;var r=(o,a,t)=>p(o,typeof a!="symbol"?a+"":a,t);import{B as m}from"./BinaryWriter-4Snmgu5s.js";const h={1:"中午",2:"晚上"},u=[{value:2,label:h[2]},{value:1,label:h[1]}],s={1:"大棚",2:"西面",3:"南面",4:"家里",5:"后面"},b=[{value:1,label:s[1]},{value:2,label:s[2]},{value:3,label:s[3]},{value:4,label:s[4]},{value:5,label:s[5]}],g="bookingStore",y="bookingStore";class B{constructor(){r(this,"data",[]);r(this,"reader",new m("Read",1));r(this,"maxId");r(this,"mapper",new Map);const a=localStorage.getItem(g);if(a)try{this.reader.setRawData(a),this.data=this.reader.readArray(t=>{const e={id:t.readInt16(),name:t.readString(),year:t.readInt16(),month:t.readInt8(),date:t.readInt8(),time:t.readInt8(),tableNum:t.readInt8(),largeTableNum:t.readInt8(),position:t.readInt8(),money:t.readInt16(),mobile:t.readString(),remark:t.readString()};return this.mapper.set(e.id,e),e})}catch(t){console.log(t)}this.maxId=this.data.length>0?Math.max(...this.data.map(t=>t.id)):0}saveStore(){const a=new m("Write",this.data.length*384);a.writeArray(this.data,(t,e)=>({id:e.writeInt16(t.id),name:e.writeString(t.name),year:e.writeInt16(t.year),month:e.writeInt8(t.month),date:e.writeInt8(t.date),time:e.writeInt8(t.time),tableNum:e.writeInt8(t.tableNum),largeTableNum:e.writeInt8(t.largeTableNum),position:e.writeInt8(t.position),money:e.writeInt16(t.money||0),mobile:e.writeString(t.mobile),remark:e.writeString(t.remark)})),localStorage.setItem(g,a.getRawDataStr())}addBooking(a){const t=++this.maxId,e={...a,id:t,money:0};this.data.push(e),this.mapper.set(t,e),this.saveStore()}updateBookingById(a,t){const e=this.data.findIndex(i=>i.id===a);this.data[e]={...this.data[e],...t},this.mapper.set(a,this.data[e])}getDateBookingList(a,t,e){return this.data.filter(i=>i.year===a&&i.month===t&&i.date===e)}getBookingById(a){return this.mapper.get(a)}getBookingListByMonthGroupByDate(a,t){const e={};for(let i=0,d=this.data.length;i<d;i++){const n=this.data[i];a===n.year&&t===n.month&&(e[n.date]||(e[n.date]=[]),e[n.date].push(n))}return e}getBookingCountByMonthGroupByDate(a,t){const e={};for(let i=0,d=this.data.length;i<d;i++){const n=this.data[i];a===n.year&&t===n.month&&(e[n.date]||(e[n.date]=0),e[n.date]++)}return e}}export{B,y as a,s as b,h as c,b as d,u as e};
