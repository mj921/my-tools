import{M as G}from"./MjButton-BmN55pLQ.js";import{M as J}from"./MjTable-D9Fewee_.js";import{d as K,a as y,r as O,c as P,o as M,b,f as C,w as U,e as N,F as _,l as V,t as Q,v as g,n as Z,u as H,z as X,A as Y,_ as ee}from"./index-C8_KvqLc.js";import"./LoadingIcon.vue_vue_type_script_setup_true_lang-Cjl4ccjb.js";import"./MjCheckbox-CRx5YV5s.js";const m=["black","limegreen","deepskyblue","blueviolet","orange","red"],L=[{name:"人族",initLevel:0,borthNum:1e4,levelUpRate:50n,powerRate:50,color:m[0]},{name:"兽族",initLevel:0,borthNum:2e4,levelUpRate:20n,powerRate:52,color:m[0]},{name:"虫族",initLevel:0,borthNum:5e4,levelUpRate:5n,powerRate:5,color:m[0]},{name:"羽族",initLevel:0,borthNum:15e3,levelUpRate:30n,powerRate:53,color:m[0]},{name:"海族",initLevel:0,borthNum:3e4,levelUpRate:20n,powerRate:45,color:m[0]},{name:"精灵族",initLevel:1,borthNum:2e3,levelUpRate:50n,powerRate:99,color:m[1]},{name:"矮人族",initLevel:1,borthNum:4e3,levelUpRate:30n,powerRate:80,color:m[1]},{name:"不死族",initLevel:2,borthNum:1e3,levelUpRate:49n,powerRate:60,color:m[2]},{name:"修罗族",initLevel:2,borthNum:200,levelUpRate:40n,powerRate:160,color:m[2]},{name:"鬼族",initLevel:2,borthNum:500,levelUpRate:45n,powerRate:125,color:m[2]},{name:"元素族",initLevel:2,borthNum:200,levelUpRate:65n,powerRate:165,color:m[2]},{name:"龙族",initLevel:3,borthNum:50,levelUpRate:60n,powerRate:215,color:m[3]},{name:"凤族",initLevel:3,borthNum:70,levelUpRate:65n,powerRate:210,color:m[3]},{name:"神族",initLevel:4,borthNum:5,levelUpRate:55n,powerRate:280,color:m[4]},{name:"仙族",initLevel:4,borthNum:10,levelUpRate:75n,powerRate:255,color:m[4]}],c=[{power:1,name:"凡体",rate:2048n,color:"gray"},{power:10,name:"地仙",rate:1024n,color:"forestgreen"},{power:100,name:"天仙",rate:512n,color:"springgreen"},{power:1e3,name:"玄仙",rate:256n,color:"mediumblue"},{power:1e4,name:"真仙",rate:128n,color:"aqua"},{power:1e5,name:"金仙",rate:64n,color:"blueviolet"},{power:1e6,name:"太乙金仙",rate:32n,color:"gold"},{power:1e7,name:"大罗金仙",rate:16n,color:"darkgoldenrod"},{power:1e8,name:"仙王",rate:8n,color:"maroon"},{power:1e9,name:"仙帝",rate:0n,color:"red"}],oe={class:"level-list"},te=["innerHTML"],le=K({__name:"ZhongZuView",setup(re){const A=[{name:"no",title:"排名",formatter:(e,s,n)=>n+1},{name:"name",title:"种族",slotName:"name"},{name:"power",title:"战力",formatter:e=>Math.floor(e)},{name:"num",title:"数量"},{name:"levelList",title:"境界详情",slotName:"levelList"}],f=y(),x=y([]),d=y(!1);let E=1;const R=e=>{x.value.push({id:E++,content:e}),Y(()=>{f.value&&(f.value.scrollTop=f.value.scrollHeight-f.value.offsetHeight)})},o=O({zuMaps:{},rank:[]}),I=()=>{let e=0;const s=L.map((l,i)=>{const p=Math.pow(6-5*o.rank.length/L.length,10-l.initLevel);return e+=p,{w:p,name:l.name,i}});let n=Math.random()*e;for(let l=0;l<s.length;l++)if(n-=s[l].w,n<0)return L[l];return L[L.length-1]},j=P(()=>o.rank.map(e=>o.zuMaps[e])),T=()=>{const e=I();if(o.zuMaps[e.name])o.zuMaps[e.name].levelList[e.initLevel]+=e.borthNum,o.zuMaps[e.name].num+=e.borthNum,o.zuMaps[e.name].power+=e.borthNum*c[e.initLevel].power*(1+e.powerRate/100);else{const s=new Array(10).fill(0);s[e.initLevel]=e.borthNum,o.zuMaps[e.name]={name:e.name,levelList:s,levelUpList:new Array(10).fill(0n),levelUpRate:e.levelUpRate,powerRate:e.powerRate,num:e.borthNum,power:e.borthNum*c[e.initLevel].power*(1+e.powerRate/100),color:e.color},o.rank.push(e.name)}o.rank.sort((s,n)=>o.zuMaps[n].power-o.zuMaps[s].power),R(`<b style="color: ${e.color}">${e.name}</b> 新增 <b>${e.borthNum}</b> <b style="color: ${c[e.initLevel].color}">${c[e.initLevel].name}</b>`)},z=(e,s=!1,n)=>{const l=o.zuMaps[e];let i=n??`<b style="color: ${l.color}">${e}</b>`,p=s;if(s)l.levelUpList=l.levelUpList.map((r,t)=>r+BigInt(l.levelList[t])*c[t].rate*(100n+l.levelUpRate)/100n),l.levelUpList.map((r,t)=>{const a=Number(r/100000n);return a>0&&(l.levelList[t]-=a,l.levelList[t+1]+=a,i+=`, ${a} <b style="color: ${c[t].color}">${c[t].name}</b> 成功突破至  <b style="color: ${c[t+1].color}">${c[t+1].name}</b>`),r%100000n});else{const r=[];l.levelList.forEach((u,h)=>{u>0&&r.push(h)});const t=r[Math.floor(Math.random()*r.length)];l.levelUpList[t]+=BigInt(l.levelList[t])*c[t].rate*(100n+l.levelUpRate)/100n;const a=Number(l.levelUpList[t]/100000n);a>0&&(p=!0,l.levelList[t]-=a,l.levelList[t+1]+=a,l.levelUpList[t]%=100000n,i+=`, ${a} <b style="color: ${c[t].color}">${c[t].name}</b> 成功突破至  <b style="color: ${c[t+1].color}">${c[t+1].name}</b>`)}if(p&&!n)l.power=l.levelList.reduce((r,t,a)=>r+t*c[a].power,0)*(1+l.powerRate/100),R(i),o.rank.sort((r,t)=>o.zuMaps[t].power-o.zuMaps[r].power);else if(p)return i},k=(e,s,n)=>{const l=o.zuMaps[e];let i=n??`<b style="color: ${l.color}">${e}</b>受到天罚`;typeof s!="number"&&(s=Math.floor(Math.random()*4)+1);let p=Math.max(1,Math.floor(l.num*s/100));for(let r=0;r<l.levelList.length;r++){const t=Math.min(p,Math.ceil(l.levelList[r]*s/100));if(t>0&&(l.levelList[r]-=t,p-=t,i+=`, ${t} <b style="color: ${c[r].color}">${c[r].name}</b> 死亡`),p<=0)break}if(n)return i;{R(i);const[r,t]=l.levelList.reduce((a,u,h)=>[a[0]+u*c[h].power,a[1]+u],[0,0]);l.power=r*(1+l.powerRate/100),l.num=t,o.rank.sort((a,u)=>o.zuMaps[u].power-o.zuMaps[a].power)}},F=e=>{let s=0;const n=o.rank.map(v=>{const w=Math.abs(o.zuMaps[v].power-o.zuMaps[e].power);return s+=w,[w,v]});let l=s*Math.random(),i=0;for(;i<n.length&&(l-=n[i][0])>=0;)i++;const p=o.rank[i];let r=e,t=p;Math.random()<o.zuMaps[e].power/(o.zuMaps[e].power+o.zuMaps[p].power)&&(r=p,t=e);let a=`<span style="color: ${o.zuMaps[e].color}">${e}</span> 与 <span style="color: ${o.zuMaps[p].color}">${p}</span> 发生冲突, <span style="color: ${o.zuMaps[t].color}">${t}</span> 获胜`;a=k(t,Math.random()*2+1,a),a=z(t,!0,a),a+=`, <span style="color: ${o.zuMaps[r].color}">${r}</span> 战败`,a=k(r,Math.random()*5+5,a),R(a);const[u,h]=o.zuMaps[t].levelList.reduce((v,w,$)=>[v[0]+w*c[$].power,v[1]+w],[0,0]);o.zuMaps[t].power=u*(1+o.zuMaps[t].powerRate/100),o.zuMaps[t].num=h;const[q,D]=o.zuMaps[r].levelList.reduce((v,w,$)=>[v[0]+w*c[$].power,v[1]+w],[0,0]);o.zuMaps[r].power=q*(1+o.zuMaps[r].powerRate/100),o.zuMaps[r].num=D,o.rank.sort((v,w)=>o.zuMaps[w].power-o.zuMaps[v].power)},S=()=>{if(o.rank.length<2){T();return}const e=1e4,s=[[600,T],[600,()=>{z(o.rank[Math.floor(Math.random()*o.rank.length)],!0)}],[400,()=>{F(o.rank[Math.floor(Math.random()*o.rank.length)])}],[400,()=>{let i=0;const p=o.rank.map((a,u)=>{const h=o.rank.length*2-u;return i+=h,[h,a]});let r=i*Math.random(),t=0;for(;t<p.length&&(r-=p[t][0])>=0;)t++;k(p[t][1])}],[8e3,()=>{o.rank.forEach(i=>z(i))}]];let n=Math.random()*e,l=0;for(;l<s.length&&(n-=s[l][0])>=0;)l++;s[l][1]()},B=()=>{d.value&&(S(),setTimeout(B,200))},W=()=>{d.value=!d.value,B()};return(e,s)=>(M(),b("div",null,[C(G,{onClick:W},{default:U(()=>[Q(g(d.value?"停止":"开始")+"衍化",1)]),_:1}),C(J,{columns:A,data:j.value,"primary-key":"name"},{name:U(({value:n})=>[N("span",{style:Z({color:o.zuMaps[n].color,fontWeight:"bold"})},g(n),5)]),levelList:U(({value:n,row:l})=>[N("div",oe,[(M(!0),b(_,null,V(n,(i,p)=>(M(),b(_,{key:l.name+"-"+p},[i>0?(M(),b("span",{key:0,style:Z({color:H(c)[p].color})},g(H(c)[p].name)+": "+g(i),5)):X("",!0)],64))),128))])]),_:1},8,["data"]),N("div",{class:"zz-log",ref_key:"logRef",ref:f},[(M(!0),b(_,null,V(x.value,n=>(M(),b("dl",{key:n.id,innerHTML:n.content},null,8,te))),128))],512)]))}}),ce=ee(le,[["__scopeId","data-v-390dcd7f"]]);export{ce as default};
